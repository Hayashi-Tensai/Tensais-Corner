<!DOCTYPE html>
<html lang="en"><head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Code Improvements - Camera Reset Function | Tensai’s Corner</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="Code Improvements - Camera Reset Function" />
<meta name="author" content="Hayashi Tensai" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Hi there! Today I will be featuring part of the script that I will be using for an ongoing project (still in early stages). It is an improved version of a function that I used back in one of my previous projects, Mirage Forest." />
<meta property="og:description" content="Hi there! Today I will be featuring part of the script that I will be using for an ongoing project (still in early stages). It is an improved version of a function that I used back in one of my previous projects, Mirage Forest." />
<link rel="canonical" href="https://tensaiscorner.com/blog/2019/03/13/code-improvements-camera-reset-function" />
<meta property="og:url" content="https://tensaiscorner.com/blog/2019/03/13/code-improvements-camera-reset-function" />
<meta property="og:site_name" content="Tensai’s Corner" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2019-03-13T13:51:00+08:00" />
<script type="application/ld+json">
{"author":{"@type":"Person","name":"Hayashi Tensai"},"headline":"Code Improvements - Camera Reset Function","dateModified":"2019-03-13T13:51:00+08:00","datePublished":"2019-03-13T13:51:00+08:00","description":"Hi there! Today I will be featuring part of the script that I will be using for an ongoing project (still in early stages). It is an improved version of a function that I used back in one of my previous projects, Mirage Forest.","url":"https://tensaiscorner.com/blog/2019/03/13/code-improvements-camera-reset-function","mainEntityOfPage":{"@type":"WebPage","@id":"https://tensaiscorner.com/blog/2019/03/13/code-improvements-camera-reset-function"},"@type":"BlogPosting","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="https://tensaiscorner.com/feed.xml" title="Tensai's Corner" /><script src="/assets/js/jquery-3.5.1.min.js"></script>
    <script src="/assets/js/youtube-autoresizer.js"></script>
</head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">Tensai&#39;s Corner</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger">
<!--<a class="page-link" href="/gamedev/enchanter/">Enchanter</a><a class="page-link" href="/about/">About</a><a class="page-link" href="/anime_stuff/">Anime Stuff</a><a class="page-link" href="/gamedev/bridge-fortress/">Bridge Fortress</a><a class="page-link" href="/game_dev_blog/">Dev Blog</a><a class="page-link" href="/gamedev/flowin-pipeline/">Flow&#39;n Pipeline</a><a class="page-link" href="/gamedev/">Game Pojects</a><a class="page-link" href="/gamedev/legend-of-the-rabbit-fiasco/">Legend of the Rabbit Fiasco</a><a class="page-link" href="/gamedev/mirage-forest/">Mirage Forest</a><a class="page-link" href="/gamedev/html_games/the_pong">The Pong</a>-->
          
        <ul class="nav-bar">
            
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
                <li>
                    <a href="/anime_stuff/" >
                      Anime Stuff
                    </a>
                </li>
              
            
              
                <li>
                    <a href="/gamedev/" >
                      Game Pojects
                    </a>
                </li>
              
            
              
                <li>
                    <a href="/game_dev_blog/" >
                      Dev Blog
                    </a>
                </li>
              
            
              
                <li>
                    <a href="/about/" >
                      About
                    </a>
                </li>
              
            
        </ul>
        </div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Code Improvements - Camera Reset Function</h1>
    <p class="post-meta" style="margin-bottom: 0px">
      <time class="dt-published" datetime="2019-03-13T13:51:00+08:00" itemprop="datePublished">Mar 13, 2019
      </time>| <span itemprop="author" itemscope itemtype="http://schema.org/Person"><span class="p-author h-card" itemprop="name">Hayashi Tensai</span></span></p>
    <p class="post-meta"><span id="viewCount"></span> views</p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p>Hi there!</p>

<p>Today I will be featuring part of the script that I will be using for an ongoing project (still in early stages). It is an improved version of a function that I used back in one of my previous projects, Mirage Forest. Here I will be sharing the difficulties and problems I faced in the older version and what I have changed.</p>

<p>Firstly let’s look into the hierarchy of the player, the script is located on the <strong>Player GameObject</strong> (I’ll call this as <strong>“parent”</strong>) of the highest hierarchy and has the <strong>camera</strong> and the <strong>character model</strong> as the children.</p>

<p><img style="max-width:80%;" src="https://raw.githubusercontent.com/Hayashi-Tensai/Tensais-Corner/master/assets/blog-images/game-dev/camera-reset-1.png" /></p>

<p>Here are two different clips featuring the effects of the old scripts and the new scripts.</p>

<p><strong>Scenario 1: Both models are set to face left and then reset camera is pressed.</strong>
<img src="https://raw.githubusercontent.com/Hayashi-Tensai/Tensais-Corner/master/assets/blog-images/game-dev/camera-reset-left-old.gif" alt="Camera Reset Left Old" /><br />
Old : camera turns counter-clockwise, taking the long way around.</p>

<p><img src="https://raw.githubusercontent.com/Hayashi-Tensai/Tensais-Corner/master/assets/blog-images/game-dev/camera-reset-left-new.gif" alt="Camera Reset Left New" /><br />
New : camera turns clockwise, taking the shortest path</p>

<p><strong>Scenario 2: Both models are set to face right and then reset camera is pressed.</strong>
<img src="https://raw.githubusercontent.com/Hayashi-Tensai/Tensais-Corner/master/assets/blog-images/game-dev/camera-reset-right-old.gif" alt="Camera Reset Right Old" /></p>

<p><img src="https://raw.githubusercontent.com/Hayashi-Tensai/Tensais-Corner/master/assets/blog-images/game-dev/camera-reset-right-new.gif" alt="Camera Reset Right New" /><br />
Both turns clockwise in this scenario</p>

<p>Following on, the scripts. Let’s look at the old script first.</p>

<p><strong>Old Script</strong></p>
<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">void</span> <span class="nf">LerpAngle</span> <span class="p">()</span>
<span class="p">{</span>
    <span class="n">transform</span><span class="p">.</span><span class="n">eulerAngles</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Vector3</span><span class="p">(</span><span class="n">transform</span><span class="p">.</span><span class="n">eulerAngles</span><span class="p">.</span><span class="n">x</span><span class="p">,</span> <span class="n">transform</span><span class="p">.</span><span class="n">eulerAngles</span><span class="p">.</span><span class="n">y</span> <span class="p">+</span> <span class="p">(</span><span class="n">lerpDamping</span> <span class="p">*</span> <span class="n">Time</span><span class="p">.</span><span class="n">deltaTime</span><span class="p">),</span> <span class="n">transform</span><span class="p">.</span><span class="n">eulerAngles</span><span class="p">.</span><span class="n">z</span><span class="p">);</span>
    <span class="n">model</span><span class="p">.</span><span class="n">transform</span><span class="p">.</span><span class="n">localEulerAngles</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Vector3</span><span class="p">(</span><span class="n">model</span><span class="p">.</span><span class="n">transform</span><span class="p">.</span><span class="n">localEulerAngles</span><span class="p">.</span><span class="n">x</span><span class="p">,</span> <span class="n">model</span><span class="p">.</span><span class="n">transform</span><span class="p">.</span><span class="n">localEulerAngles</span><span class="p">.</span><span class="n">y</span> <span class="p">-</span> <span class="p">(</span><span class="n">lerpDamping</span> <span class="p">*</span> <span class="n">Time</span><span class="p">.</span><span class="n">deltaTime</span><span class="p">),</span> <span class="n">model</span><span class="p">.</span><span class="n">transform</span><span class="p">.</span><span class="n">localEulerAngles</span><span class="p">.</span><span class="n">z</span><span class="p">);</span>

    <span class="k">if</span><span class="p">(</span><span class="n">model</span><span class="p">.</span><span class="n">transform</span><span class="p">.</span><span class="n">localRotation</span><span class="p">.</span><span class="n">y</span> <span class="p">&lt;=</span> <span class="m">0.0f</span><span class="p">)</span>
        <span class="n">isLerping</span> <span class="p">=</span> <span class="k">false</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>
<p>The old script is relatively simple, <strong>the parent</strong> will turn clockwise on an a certain interval wihile, the <strong>character model</strong> will turn counter-clockwise countering the <strong>parent’s</strong> movement, and it will continue until the <strong>character model’s</strong> local rotation goes less than or equal to zero.</p>

<p>Problems with this code:</p>
<ul>
  <li>It only turns clockwise, potentially taking a longer path to rotate as seen the left clip above.</li>
  <li>The angle after it stops is not at zero (It will overshoot by around 8 - 11 degrees).</li>
</ul>

<p><strong>New Script</strong></p>
<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">void</span> <span class="nf">LerpAngle</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">Vector3</span> <span class="n">modelAngle</span> <span class="p">=</span> <span class="n">model</span><span class="p">.</span><span class="n">transform</span><span class="p">.</span><span class="n">localEulerAngles</span><span class="p">;</span> <span class="c1">//! Euler angles of the character model</span>
    <span class="n">Vector3</span> <span class="n">parentAngle</span> <span class="p">=</span> <span class="n">transform</span><span class="p">.</span><span class="n">eulerAngles</span><span class="p">;</span> <span class="c1">//! Euler angles of the parent object</span>
    <span class="kt">float</span> <span class="n">lerpRate</span> <span class="p">=</span> <span class="n">lerpDamping</span> <span class="p">*</span> <span class="n">Time</span><span class="p">.</span><span class="n">deltaTime</span><span class="p">;</span>


    <span class="k">if</span> <span class="p">(</span><span class="n">modelAngle</span><span class="p">.</span><span class="n">y</span> <span class="p">&lt;=</span> <span class="m">12.0f</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">transform</span><span class="p">.</span><span class="n">eulerAngles</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Vector3</span><span class="p">(</span><span class="n">parentAngle</span><span class="p">.</span><span class="n">x</span><span class="p">,</span> <span class="n">parentAngle</span><span class="p">.</span><span class="n">y</span> <span class="p">+</span> <span class="n">modelAngle</span><span class="p">.</span><span class="n">y</span><span class="p">,</span> <span class="n">parentAngle</span><span class="p">.</span><span class="n">z</span><span class="p">);</span>
        <span class="n">model</span><span class="p">.</span><span class="n">transform</span><span class="p">.</span><span class="n">localEulerAngles</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Vector3</span><span class="p">(</span><span class="n">modelAngle</span><span class="p">.</span><span class="n">x</span><span class="p">,</span> <span class="m">0.0f</span><span class="p">,</span> <span class="n">modelAngle</span><span class="p">.</span><span class="n">z</span><span class="p">);</span>
        <span class="n">isLerping</span> <span class="p">=</span> <span class="k">false</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">modelAngle</span><span class="p">.</span><span class="n">y</span> <span class="p">&gt;=</span> <span class="m">348.0f</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">transform</span><span class="p">.</span><span class="n">eulerAngles</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Vector3</span><span class="p">(</span><span class="n">parentAngle</span><span class="p">.</span><span class="n">x</span><span class="p">,</span> <span class="n">parentAngle</span><span class="p">.</span><span class="n">y</span> <span class="p">-</span> <span class="p">(</span><span class="m">360.0f</span> <span class="p">-</span> <span class="n">modelAngle</span><span class="p">.</span><span class="n">y</span><span class="p">),</span> <span class="n">parentAngle</span><span class="p">.</span><span class="n">z</span><span class="p">);</span>
        <span class="n">model</span><span class="p">.</span><span class="n">transform</span><span class="p">.</span><span class="n">localEulerAngles</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Vector3</span><span class="p">(</span><span class="n">modelAngle</span><span class="p">.</span><span class="n">x</span><span class="p">,</span> <span class="m">0.0f</span><span class="p">,</span> <span class="n">modelAngle</span><span class="p">.</span><span class="n">z</span><span class="p">);</span>
        <span class="n">isLerping</span> <span class="p">=</span> <span class="k">false</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">modelAngle</span><span class="p">.</span><span class="n">y</span> <span class="p">&gt;</span> <span class="m">12.0f</span> <span class="p">&amp;&amp;</span> <span class="n">modelAngle</span><span class="p">.</span><span class="n">y</span> <span class="p">&lt;=</span> <span class="m">180.0f</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">transform</span><span class="p">.</span><span class="n">eulerAngles</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Vector3</span><span class="p">(</span><span class="n">parentAngle</span><span class="p">.</span><span class="n">x</span><span class="p">,</span> <span class="n">parentAngle</span><span class="p">.</span><span class="n">y</span> <span class="p">+</span> <span class="n">lerpRate</span><span class="p">,</span> <span class="n">parentAngle</span><span class="p">.</span><span class="n">z</span><span class="p">);</span>
        <span class="n">model</span><span class="p">.</span><span class="n">transform</span><span class="p">.</span><span class="n">localEulerAngles</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Vector3</span><span class="p">(</span><span class="n">modelAngle</span><span class="p">.</span><span class="n">x</span><span class="p">,</span> <span class="n">modelAngle</span><span class="p">.</span><span class="n">y</span> <span class="p">-</span> <span class="n">lerpRate</span><span class="p">,</span> <span class="n">modelAngle</span><span class="p">.</span><span class="n">z</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">modelAngle</span><span class="p">.</span><span class="n">y</span> <span class="p">&gt;</span> <span class="m">180.0f</span> <span class="p">&amp;&amp;</span> <span class="n">modelAngle</span><span class="p">.</span><span class="n">y</span> <span class="p">&lt;</span> <span class="m">348.0f</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">transform</span><span class="p">.</span><span class="n">eulerAngles</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Vector3</span><span class="p">(</span><span class="n">parentAngle</span><span class="p">.</span><span class="n">x</span><span class="p">,</span> <span class="n">parentAngle</span><span class="p">.</span><span class="n">y</span> <span class="p">-</span> <span class="n">lerpRate</span><span class="p">,</span> <span class="n">parentAngle</span><span class="p">.</span><span class="n">z</span><span class="p">);</span>
        <span class="n">model</span><span class="p">.</span><span class="n">transform</span><span class="p">.</span><span class="n">localEulerAngles</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Vector3</span><span class="p">(</span><span class="n">modelAngle</span><span class="p">.</span><span class="n">x</span><span class="p">,</span> <span class="n">modelAngle</span><span class="p">.</span><span class="n">y</span> <span class="p">+</span> <span class="n">lerpRate</span><span class="p">,</span> <span class="n">modelAngle</span><span class="p">.</span><span class="n">z</span><span class="p">);</span>
    <span class="p">}</span>

<span class="p">}</span>
</code></pre></div></div>
<p>As for the new script, I made the variables modelAngle, parentAngle and lerpRate, to reduce the amount of long repetitions of long lines of codes. I also made a change to the if conditions to check for localEularAnlgles rather than the local rotation, as it makes more sense that way since the euler angles is the one being modified. It also makes it a lot easier to use because euler angles only stays within the range of 0 - 360 degrees.</p>

<p>Then, as for the issues above:</p>
<ul>
  <li>The code has now several conditons to check for the current euler angles of the <strong>character model</strong> to consider whether to turn clockwise or anticlockwise to take the shortest path.</li>
  <li>The top two conditions on the other hand handles the problem where the angle does not end up at zero, which when the lerping processing reaches less than a 12 degree difference from zero from either direction, it clips right away to zero.</li>
</ul>

<p>That’s for for now, hope to write more about the project soon!</p>

  </div><!--if page.comments != false and jekyll.environment == "production-->

  <div id="disqus_thread"></div>
  <script>
    var disqus_config = function () {
      this.page.url = 'https://tensaiscorner.com/blog/2019/03/13/code-improvements-camera-reset-function';
      this.page.identifier = 'https://tensaiscorner.com/blog/2019/03/13/code-improvements-camera-reset-function';
    };

    (function() {
      var d = document, s = d.createElement('script');

      s.src = 'https://tensais-corner.disqus.com/embed.js';

      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript><a class="u-url" href="/blog/2019/03/13/code-improvements-camera-reset-function" hidden></a>
</article>

<script>
    var xPost = new Object();
    
    $(document).ready( function (){
        xPost.IncreaseViewCount();
    });
    
    xPost.IncreaseViewCount = function (){
        let xmlHttp = new XMLHttpRequest();
        xmlHttp.open('GET', 'https://hayashitensai.pythonanywhere.com/count', false);
        xmlHttp.send(null);
        count = xmlHttp.responseText;
        
        $("#viewCount").html(count);
    };
    
</script>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <!--<h2 class="footer-heading">Tensai&#39;s Corner</h2>-->

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
            <li class="p-name">Tensai&#39;s Corner</li>
            <li>© 2017 - 2020 Hayashi Tensai</li>
        </ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a class="u-email" href="mailto:tensaiscorner@gmail.com"><img class="svg-icon" src="https://raw.githubusercontent.com/Hayashi-Tensai/Tensais-Corner/b23fa27bb15ad2d09e34d57266ce983480d53ae8/assets/icon/icon-email.svg"/>tensaiscorner@gmail.com</a></li><li><a href="https://github.com/Hayashi-Tensai"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">Hayashi-Tensai</span></a></li></ul>
</div>

<!--      <div class="footer-col footer-col-3">
        <p>Personal Portfolio and Blogs</p>
      </div>-->
    </div>

  </div>

</footer>
</body>

</html>
